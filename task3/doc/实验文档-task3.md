

# BP-模型与超参数调优

基准模型: 四层+Relu+Dropout(0.2)
```py
Net(
  (0): Flatten()
  (1): Mlp(in_features=784, out_features=256)
  (2): Relu()
  (3): Dropout(p=0.2)
  (4): Mlp(in_features=256, out_features=64)
  (5): Relu()
  (6): Dropout(p=0.2)
  (7): Mlp(in_features=64, out_features=16)
  (8): Relu()
  (9): Dropout(p=0.2)
  (10): Mlp(in_features=16, out_features=10)
  (11): Softmax()
)
```


|    统一参数    |             |
| :------------: | :---------: |
|     数据集     | MNIST (4:1) |
| 学习率容忍次数 |     10      |
| 学习率衰减因子 |     0.5     |
| 无增长容忍次数 |     40      |

|  基准参数  |              |
| :--------: | :----------: |
|  损失函数  | CrossEntropy |
|  激活函数  |     Relu     |
|   批大小   |     512      |
| 初始学习率 |      1       |


| 模型架构 | 激活函数 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :---------------: | :----------: | :--------: |
| 两层+MSE |   Relu   |                   |     120      |   96.89%   |
|   两层   |   Relu   |        28         |     109      |   97.38%   |
|   三层   |   Relu   |        81         |     137      |   97.17%   |
|   四层   |   Relu   |        114        |     138      |   97.06%   |

| 模型架构 | 激活函数 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :---------------: | :----------: | :--------: |
|   两层   |   Gelu   |        27         |      76      |   97.35%   |
|   三层   |   Gelu   |        81         |     131      |   97.29%   |
|   四层   |   Gelu   |        115        |     122      |   97.04%   |

| 模型架构 | 激活函数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :----------: | :--------: |
|   两层   | Sigmoid  |     109      |   96.38%   |
|   三层   | Sigmoid  |     126      |   96.13%   |

| 模型架构 | 批大小 | 初始学习率 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :----: | :--------: | :---------------: | :----------: | :--------: |
|   两层   |  1024  |     1      |        107        |     168      |   97.15%   |
|   两层   |  512   |     1      |        28         |     109      |   97.38%   |
|   两层   |  256   |     1      |        14         |      46      |   97.45%   |
|   两层   |  128   |    0.1     |        16         |     106      |   97.51%   |
|   两层   |   64   |    0.1     |         5         |      33      |   97.83%   |


| 模型架构 | 初始学习率 | 最佳迭代次数 | 最佳准确率 |
| :------: | :--------: | :----------: | :--------: |
|   两层   |     1      |     109      |   97.38%   |
|   两层   |    0.1     |     279      |   96.82%   |
|   两层   |    0.05    |     296      |   96.53%   |


| 模型架构 | 消融率 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :----: | :---------------: | :----------: | :--------: |
|   三层   |   0    |        81         |     137      |   97.17%   |
|   三层   |  0.1   |        81         |     200      |   97.46%   |
|   三层   |  0.15  |        80         |     172      |   97.52%   |
|   三层   |  0.2   |        79         |     179      |   97.47%   |
|   三层   |  0.3   |        105        |     177      |   97.33%   |
|   三层   |  0.4   |                   |     147      |   96.83%   |


# CNN-模型与超参数调优


|    统一参数    |                   |
| :------------: | :---------------: |
|     数据集     |   CIFAR10 (4:1)   |
| 学习率容忍次数 |        10         |
| 学习率衰减因子 |        0.5        |
| 无增长容忍次数 |        40         |
|     优化器     |       AdamW       |
|  学习率调节器  | ReduceLROnPlateau |
|    激活函数    |       Relu        |
|    损失函数    |   CrossEntropy    |
|     批大小     |        128        |
|   初始学习率   |       1e-2        |
|  线性层消融率  |        0.5        |

| 基准参数 |          |
| :------: | :------: |
|  卷积核  |   3x3    |
| 池化方式 | 最大池化 |


| n*[Conv+Poll]+MLP | 参数量  | 迭代用时 | 最佳迭代次数 | 最佳准确率 |
| :---------------: | :-----: | :------: | :----------: | :--------: |
|       一层        | 8402890 | 0.86s/it |      80      |   71.91%   |
|       两层        | 4227210 | 0.87s/it |      63      |   77.82%   |
|       三层        | 2204170 | 0.98s/it |     153      |   81.11%   |
|       四层        | 1451274 | 1.07s/it |     150      |   78.99%   |


| n*[2Conv+Poll]+MLP | 参数量  | 迭代用时 | 最佳迭代次数 | 最佳准确率 |
| :----------------: | :-----: | :------: | :----------: | :--------: |
|        一层        | 8412202 | 1.09s/it |     145      |   75.17%   |
|        两层        | 4273578 | 1.14s/it |     147      |   82.58%   |
|        三层        | 2398378 | 1.29s/it |      99      |   84.72%   |
|        四层        | 2236074 | 1.53s/it |      32      |   83.33%   |


| n*[2Conv+Poll]+MLP | 卷积核 | 参数量  | 迭代用时 | 最佳迭代次数 | 最佳准确率 |
| :----------------: | :----: | :-----: | :------: | :----------: | :--------: |
|        一层        |   3    | 8412202 | 1.09s/it |     145      |   75.17%   |
|        一层        |   5    | 8430122 | 1.37s/it |     117      |   75.30%   |
|        一层        |   7    | 8457002 | 1.66s/it |     111      |   74.62%   |


| n*[2Conv+Poll]+MLP | 池化方式 | 迭代用时 | 最佳迭代次数 | 最佳准确率 |
| :----------------: | :------: | :------: | :----------: | :--------: |
|        一层        |   最大   | 1.09s/it |     145      |   75.17%   |
|        一层        |   平均   | 1.11s/it |      81      |   74.29%   |





