

# BP-模型与超参数调优

基准模型: 四层+Relu+Dropout(0.3)
```py
Net(
  (0): Flatten()
  (1): Mlp(in_features=784, out_features=256)
  (2): Relu()
  (3): Dropout(p=0.3)
  (4): Mlp(in_features=256, out_features=64)
  (5): Relu()
  (6): Dropout(p=0.3)
  (7): Mlp(in_features=64, out_features=16)
  (8): Relu()
  (9): Dropout(p=0.3)
  (10): Mlp(in_features=16, out_features=10)
  (11): Softmax()
)
```


| 统一训练参数   |                          |
| -------------- | ------------------------ |
| 数据集         | MNIST (训练集4: 验证集1) |
| 学习率容忍次数 | 10                       |
| 学习率衰减因子 | 0.5                      |
| 无增长容忍次数 | 40                       |



| 模型架构 | 激活函数 |   损失函数   | 批大小 | 初始学习率 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :----------: | :----: | :--------: | :---------------: | :----------: | :--------: |
|   两层   |   Relu   |     MSE      |  512   |     1      |                   |     120      |   96.89%   |
|   两层   |   Relu   | CrossEntropy |  512   |     1      |        28         |     109      |   97.38%   |
|   三层   |   Relu   | CrossEntropy |  512   |     1      |        81         |     137      |   97.17%   |
|   四层   |   Relu   | CrossEntropy |  512   |     1      |        114        |     138      |   97.06%   |

| 模型架构 | 激活函数 |   损失函数   | 批大小 | 初始学习率 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :----------: | :----: | :--------: | :---------------: | :----------: | :--------: |
|   两层   |   Gelu   | CrossEntropy |  512   |     1      |        27         |      76      |   97.35%   |
|   三层   |   Gelu   | CrossEntropy |  512   |     1      |        81         |     131      |   97.29%   |
|   四层   |   Gelu   | CrossEntropy |  512   |     1      |        115        |     122      |   97.04%   |

| 模型架构 | 激活函数 |   损失函数   | 批大小 | 初始学习率 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :----------: | :----: | :--------: | :----------: | :--------: |
|   两层   | Sigmoid  | CrossEntropy |  512   |     20     |     109      |   96.38%   |
|   三层   | Sigmoid  | CrossEntropy |  512   |     20     |     126      |   96.13%   |

| 模型架构 | 激活函数 |   损失函数   | 批大小 | 初始学习率 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :----------: | :----: | :--------: | :---------------: | :----------: | :--------: |
|   两层   |   Relu   | CrossEntropy |  1024  |     1      |        107        |     168      |   97.15%   |
|   两层   |   Relu   | CrossEntropy |  512   |     1      |        28         |     109      |   97.38%   |
|   两层   |   Relu   | CrossEntropy |  256   |     1      |        14         |      46      |   97.45%   |
|   两层   |   Relu   | CrossEntropy |  128   |    0.1     |        16         |     106      |   97.51%   |
|   两层   |   Relu   | CrossEntropy |   64   |    0.1     |         5         |      33      |   97.83%   |


| 模型架构 | 激活函数 |   损失函数   | 批大小 | 初始学习率 | 最佳迭代次数 | 最佳准确率 |
| :------: | :------: | :----------: | :----: | :--------: | :----------: | :--------: |
|   两层   |   Relu   | CrossEntropy |  512   |     1      |     109      |   97.38%   |
|   两层   |   Relu   | CrossEntropy |  512   |    0.1     |     279      |   96.82%   |
|   两层   |   Relu   | CrossEntropy |  512   |    0.05    |     296      |   96.53%   |

| 模型架构 | 消融率 | 激活函数 |   损失函数   | 批大小 | 初始学习率 | 准确率97%迭代次数 | 最佳迭代次数 | 最佳准确率 |
| :------: | :----: | :------: | :----------: | :----: | :--------: | :---------------: | :----------: | :--------: |
|   三层   |   0    |   Relu   | CrossEntropy |  512   |     1      |        81         |     137      |   97.17%   |
|   三层   |  0.1   |   Relu   | CrossEntropy |  512   |     1      |        81         |     200      |   97.46%   |
|   三层   |  0.2   |   Relu   | CrossEntropy |  512   |     1      |        79         |     179      |   97.47%   |
|   三层   |  0.3   |   Relu   | CrossEntropy |  512   |     1      |        105        |     177      |   97.33%   |
|   三层   |  0.4   |   Relu   | CrossEntropy |  512   |     1      |                   |     147      |   96.83%   |
